<!DOCTYPE html>

<html>

    <head>

        <script src = "scripts/FunctionReference.js" defer></script>
        
        <script src = "scripts/lexer/Token.js" defer></script>
        <script src = "scripts/lexer/LexerInput.js" defer></script>
        <script src = "scripts/lexer/Lexer.js" defer></script>

        <script src = "scripts/lexer/characters.js" defer></script>
        <script src = "scripts/lexer/identifiers.js" defer></script>
        <script src = "scripts/lexer/types.js" defer></script>
        <script src = "scripts/lexer/whitespace.js" defer></script>
        <script src = "scripts/lexer/literals.js" defer></script>
        <script src = "scripts/lexer/base.js" defer></script>

    </head>

    <body>
        <textarea rows=40 cols=70 id = "ta">
putTodo :: (Int, String) -> IO ()
putTodo (n, todo) = putStrLn (show n ++ ": " ++ todo)

prompt :: [String] -> IO ()
prompt todos = do
    putStrLn ""
    putStrLn "Current TODO list:"
    mapM_ putTodo (zip [0..] todos)
    command <- getLine
    interpret command todos

interpret :: String -> [String] -> IO ()
interpret ('+':' ':todo) todos = prompt (todo:todos)
interpret ('-':' ':num ) todos =
    case delete (read num) todos of
        Nothing -> do
            putStrLn "No TODO entry matches the given number"
            prompt todos
        Just todos' -> prompt todos'
interpret  "q"           todos = return ()
interpret  command       todos = do
    putStrLn ("Invalid command: `" ++ command ++ "`")
    prompt todos

delete :: Int -> [a] -> Maybe [a]
delete 0 (_:as) = Just as
delete n (a:as) = do
    as' <- delete (n - 1) as
    return (a:as')
delete _  []    = Nothing

main = do
    putStrLn "Commands:"
    putStrLn "+ <String> - Add a TODO entry"
    putStrLn "- <Int>    - Delete the numbered entry"
    putStrLn "q          - Quit"
    prompt []
        </textarea>
        <br>
        <button onclick="test(t_program, document.getElementById('ta').value)">Lex</button>
        <div id="time" style="font-family: monospace;"></div>
        <div id="tokens" style="font-family: monospace; position: absolute; top: 25px; left: 575px;"></div>
    </body>

</html>